(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["35cfc3f4"],{"27ae":function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(t,e){module.exports=e(t)})("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:this,function(global){"use strict";global=global||{};var _Base64=global.Base64,version="2.5.1",buffer;if(module.exports)try{buffer=eval("require('buffer').Buffer")}catch(t){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(t){for(var e={},n=0,r=t.length;n<r;n++)e[t.charAt(n)]=n;return e}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(t){if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?fromCharCode(192|e>>>6)+fromCharCode(128|63&e):fromCharCode(224|e>>>12&15)+fromCharCode(128|e>>>6&63)+fromCharCode(128|63&e)}e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return fromCharCode(240|e>>>18&7)+fromCharCode(128|e>>>12&63)+fromCharCode(128|e>>>6&63)+fromCharCode(128|63&e)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(t){return t.replace(re_utob,cb_utob)},cb_encode=function(t){var e=[0,2,1][t.length%3],n=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0),r=[b64chars.charAt(n>>>18),b64chars.charAt(n>>>12&63),e>=2?"=":b64chars.charAt(n>>>6&63),e>=1?"=":b64chars.charAt(63&n)];return r.join("")},btoa=global.btoa?function(t){return global.btoa(t)}:function(t){return t.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(t){return(t.constructor===buffer.constructor?t:buffer.from(t)).toString("base64")}:function(t){return(t.constructor===buffer.constructor?t:new buffer(t)).toString("base64")}:function(t){return btoa(utob(t))},encode=function(t,e){return e?_encode(String(t)).replace(/[+\/]/g,function(t){return"+"==t?"-":"_"}).replace(/=/g,""):_encode(String(t))},encodeURI=function(t){return encode(t,!0)},re_btou=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),cb_btou=function(t){switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return fromCharCode(55296+(n>>>10))+fromCharCode(56320+(1023&n));case 3:return fromCharCode((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return fromCharCode((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},btou=function(t){return t.replace(re_btou,cb_btou)},cb_decode=function(t){var e=t.length,n=e%4,r=(e>0?b64tab[t.charAt(0)]<<18:0)|(e>1?b64tab[t.charAt(1)]<<12:0)|(e>2?b64tab[t.charAt(2)]<<6:0)|(e>3?b64tab[t.charAt(3)]:0),i=[fromCharCode(r>>>16),fromCharCode(r>>>8&255),fromCharCode(255&r)];return i.length-=[0,0,2,1][n],i.join("")},_atob=global.atob?function(t){return global.atob(t)}:function(t){return t.replace(/\S{1,4}/g,cb_decode)},atob=function(t){return _atob(String(t).replace(/[^A-Za-z0-9\+\/]/g,""))},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(t){return(t.constructor===buffer.constructor?t:buffer.from(t,"base64")).toString()}:function(t){return(t.constructor===buffer.constructor?t:new buffer(t,"base64")).toString()}:function(t){return btou(_atob(t))},decode=function(t){return _decode(String(t).replace(/[-_]/g,function(t){return"-"==t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var t=global.Base64;return global.Base64=_Base64,t};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"===typeof Object.defineProperty){var noEnum=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum(function(){return decode(this)})),Object.defineProperty(String.prototype,"toBase64",noEnum(function(t){return encode(this,t)})),Object.defineProperty(String.prototype,"toBase64URI",noEnum(function(){return encode(this,!0)}))}}return global["Meteor"]&&(Base64=global.Base64),module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}})}).call(this,__webpack_require__("c8ba"))},6870:function(t,e,n){},"84a3":function(t,e,n){"use strict";var r=n("af3c"),i=n.n(r);i.a},af3c:function(t,e,n){},eb60:function(t,e,n){"use strict";var r=n("6870"),i=n.n(r);i.a},f241:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-layout",{attrs:{view:"hHh Lpr lFf"}},[n("client-settings",{attrs:{settings:t.currentSettings},on:{save:t.saveSettingsHandler,hide:t.hideSettingsHandler},model:{value:t.clientSettingsOpened,callback:function(e){t.clientSettingsOpened=e},expression:"clientSettingsOpened"}}),n("q-layout-header",[n("q-toolbar",{attrs:{color:"dark"}},[t.fullViewMode?n("q-btn",{staticClass:"lt-lg",attrs:{flat:"",rounded:"",icon:"mdi-menu"},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}}):t._e(),n("q-toolbar-title",{staticStyle:{"line-height":"36px"}},[n("img",{staticStyle:{height:"30px","vertical-align":"text-bottom"},attrs:{src:"statics/mqtttiles-logo.png",alt:"MQTT Tiles"}}),t._v("\n        MQTT Tiles\n        "),n("sup",{staticStyle:{position:"relative","font-size":".9rem","padding-left":"4px"}},[t._v(t._s(t.version))])])],1)],1),t.fullViewMode?n("q-layout-drawer",{attrs:{side:"left"},model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}},[n("div",{staticClass:"connections__subheader q-px-md bg-dark",staticStyle:{position:"relative",height:"70px"}},[n("span",{staticClass:"text-white",staticStyle:{"font-size":"1.4rem","line-height":"70px"}},[t._v("My connections")]),n("q-btn",{staticClass:"text-dark",staticStyle:{position:"absolute",bottom:"-20px",right:"16px","z-index":"1"},attrs:{"fab-mini":"",icon:"mdi-plus",color:"white"},on:{click:t.openSettings}})],1),t.clientsIds.length?n("q-list",{staticClass:"scroll",staticStyle:{position:"absolute",top:"70px",bottom:"0",right:"0",left:"0"}},[n("q-list-header",[n("span",[t._v("Connections")])]),t._l(t.clients,function(e,r){var i;return n("q-item",{key:r,staticClass:"cursor-pointer",class:{active:r===t.activeClientId},nativeOn:{click:function(e){t.setActiveClient(r)}}},[n("q-item-side",[n("q-icon",{attrs:{name:t.connected?"mdi-lan-connect":"mdi-lan-disconnect"}},[r===t.activeClientId?n("q-tooltip",[t._v(t._s(t.connected?"Connected":"Disconnected"))]):t._e()],1)],1),n("q-item-main",[n("q-item-tile",{staticClass:"ellipsis",class:(i={},i["text-"+(t.connected?"green":"red")+"-6"]=r===t.activeClientId,i),attrs:{label:""}},[t._v("\n            "+t._s(e.clientName)+"\n          ")]),n("q-item-tile",{staticClass:"ellipsis",attrs:{sublabel:""}},[t._v(t._s(e.host))])],1),n("q-item-side",{attrs:{right:""}},[n("q-btn",{attrs:{round:"",flat:"",icon:"mdi-dots-vertical"},on:{click:function(t){t.stopPropagation()}}},[n("q-popover",{attrs:{anchor:"bottom right",self:"top right"}},[n("q-list",[n("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],staticClass:"cursor-pointer",attrs:{highlight:""},nativeOn:{click:function(e){t.editClientSettings(r)}}},[n("q-item-side",{attrs:{icon:"mdi-settings"}}),n("q-item-main",{attrs:{label:"Edit"}})],1),n("q-item-separator"),n("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],staticClass:"cursor-pointer",attrs:{highlight:""},nativeOn:{click:function(e){t.removeClient(r)}}},[n("q-item-side",{attrs:{color:"red",icon:"mdi-delete-outline"}}),n("q-item-main",{attrs:{label:"Remove"}})],1)],1)],1)],1)],1)],1)})],2):n("div",{staticClass:"q-px-md q-pt-lg text-center"},[n("div",{staticClass:"text-bold"},[t._v("No connections")]),n("div",{staticStyle:{"font-size":".8rem"}},[t._v("Create a connection to visualize its data on boards")])])],1):t._e(),n("q-page-container",[n("router-view",{attrs:{client:t.clients[t.activeClientId]},on:{"change:status":t.changeStatus,share:t.shareHandler}})],1)],1)},i=[];r._withStripped=!0;n("6b54"),n("a481"),n("ac6a"),n("cadf"),n("456d");var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-modal",{on:{hide:t.closeHandler},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[n("q-modal-layout",[n("q-toolbar",{attrs:{slot:"header",color:"dark"},slot:"header"},[n("q-toolbar-title",[t._v("\n        MQTT client\n      ")])],1),n("div",{staticStyle:{margin:"20px"},style:{height:t.$q.platform.is.mobile?"calc(100% - 100px)":"50vh",width:t.$q.platform.is.mobile?"calc(100% - 40px)":"50vw"}},[n("q-input",{attrs:{color:"dark","float-label":"MQTT client name",error:!t.currentSettings.clientName},model:{value:t.currentSettings.clientName,callback:function(e){t.$set(t.currentSettings,"clientName",e)},expression:"currentSettings.clientName"}}),n("q-input",{attrs:{color:"dark","float-label":"Client ID",error:!t.currentSettings.clientId,after:[{icon:"mdi-refresh",handler:function(){t.currentSettings.clientId="mqtt-tiles-"+Math.random().toString(16).substr(2,8)}}]},model:{value:t.currentSettings.clientId,callback:function(e){t.$set(t.currentSettings,"clientId",e)},expression:"currentSettings.clientId"}}),n("q-input",{attrs:{color:"dark","float-label":"Host",error:!t.currentSettings.host||0===t.currentSettings.host.indexOf("ws:"),after:[{icon:"mdi-alert-outline",handler:t.hostErrorHandler,error:!0}]},model:{value:t.currentSettings.host,callback:function(e){t.$set(t.currentSettings,"host",e)},expression:"currentSettings.host"}}),n("q-input",{attrs:{color:"dark",type:"number","float-label":"Keep alive"},model:{value:t.currentSettings.keepalive,callback:function(e){t.$set(t.currentSettings,"keepalive",e)},expression:"currentSettings.keepalive"}}),n("q-select",{attrs:{color:"dark",options:[{label:"3.1.1",value:4},{label:"5.0",value:5}],"float-label":"Version of MQTT"},model:{value:t.currentSettings.protocolVersion,callback:function(e){t.$set(t.currentSettings,"protocolVersion",e)},expression:"currentSettings.protocolVersion"}}),n("q-checkbox",{staticClass:"q-mr-sm",staticStyle:{height:"56px"},attrs:{color:"dark",label:5===t.currentSettings.protocolVersion?"Clean start":"Clean session"},model:{value:t.currentSettings.clean,callback:function(e){t.$set(t.currentSettings,"clean",e)},expression:"currentSettings.clean"}}),5===t.currentSettings.protocolVersion?n("q-input",{staticStyle:{display:"inline-flex",width:"calc(100% - 115px)"},attrs:{color:"dark",type:"number","float-label":"Session expiry interval",clearable:"","clear-value":void 0},model:{value:t.currentSettings.properties.sessionExpiryInterval,callback:function(e){t.$set(t.currentSettings.properties,"sessionExpiryInterval",e)},expression:"currentSettings.properties.sessionExpiryInterval"}}):t._e(),n("q-input",{attrs:{color:"dark","float-label":"Username","clear-value":void 0,after:[{icon:"mdi-login",handler:t.flespiLoginHandler,condition:-1!==t.currentSettings.host.indexOf("flespi")}]},model:{value:t.currentSettings.username,callback:function(e){t.$set(t.currentSettings,"username",e)},expression:"currentSettings.username"}}),n("q-input",{attrs:{color:"dark","float-label":"Password","clear-value":void 0},model:{value:t.currentSettings.password,callback:function(e){t.$set(t.currentSettings,"password",e)},expression:"currentSettings.password"}}),5===t.currentSettings.protocolVersion?n("q-collapsible",{staticClass:"q-mt-md q-mb-sm bg-grey-4",attrs:{label:"Subscribe User Properties"}},[n("div",[t.currentSettings.userProperties?n("q-list",t._l(t.currentSettings.userProperties,function(e,r){return n("q-item",{key:r+": "+e},[n("q-icon",{staticClass:"q-mr-sm cursor-pointer",attrs:{size:"1rem",name:"mdi-close-circle"},nativeOn:{click:function(e){t.removeUserProperty(r)}}}),n("span",[t._v(t._s(r+": "+e))])],1)})):t._e(),n("q-input",{attrs:{color:"dark","float-label":"User property name"},model:{value:t.userProperty.name,callback:function(e){t.$set(t.userProperty,"name",e)},expression:"userProperty.name"}}),n("q-input",{attrs:{color:"dark","float-label":"User property value"},model:{value:t.userProperty.value,callback:function(e){t.$set(t.userProperty,"value",e)},expression:"userProperty.value"}}),n("q-btn",{staticClass:"q-mt-sm",staticStyle:{width:"100%"},attrs:{disable:!t.userProperty.name||!t.userProperty.value,color:"dark"},on:{click:t.addUserProperty}},[t._v("Add")])],1)]):t._e()],1),n("q-toolbar",{attrs:{slot:"footer",color:"dark"},slot:"footer"},[n("q-toolbar-title"),n("q-btn",{staticClass:"q-mr-sm",attrs:{flat:"",dense:""},on:{click:t.closeHandler}},[t._v("Close")]),n("q-btn",{attrs:{flat:"",dense:"",disable:!t.validateCurrentSettings},on:{click:t.saveSettingsHandler}},[t._v(t._s(t.settings?"Update":"Save"))])],1)],1)],1)},s=[];o._withStripped=!0;n("7f7f");var a=n("42454"),c=n.n(a),l=function(){return{clientName:"New client",clientId:"mqtt-tiles-".concat(Math.random().toString(16).substr(2,8)),host:"wss://mqtt.flespi.io",keepalive:60,protocolVersion:5,clean:!0,username:"FlespiToken XXXXXXXXXXXXXXXXXXX",password:"",properties:{sessionExpiryInterval:void 0},syncNamespace:"xflespifront/mqtttiles/boards"}},u={name:"ClientSettings",props:["value","settings"],data:function(){var t=l();return{defaultSettings:t,currentSettings:this.settings?c()({},t,this.settings):c()({},t),userProperty:{name:"",value:""}}},computed:{validateCurrentSettings:function(){return!!this.currentSettings.clientId&&!!this.currentSettings.host&&!(0===this.currentSettings.host.indexOf("ws:"))},status:function(){return this.value}},methods:{saveSettingsHandler:function(){var t=this;this.$emit("save",this.currentSettings),this.closeHandler(),this.$nextTick(function(){t.defaultSettings.clientId="mqtt-tiles-".concat(Math.random().toString(16).substr(2,8)),t.currentSettings=c()({},t.defaultSettings)})},closeHandler:function(){this.$emit("input",!1),this.$emit("hide")},hostErrorHandler:function(){this.$q.notify({message:"Host must be not empty and only over secured sockets"})},addUserProperty:function(){this.currentSettings.userProperties||this.$set(this.currentSettings,"userProperties",{}),this.$set(this.currentSettings.userProperties,this.userProperty.name,this.userProperty.value),this.userProperty={value:"",name:""}},removeUserProperty:function(t){this.$delete(this.currentSettings.userProperties,t),Object.keys(this.currentSettings.userProperties).length||this.$set(this.currentSettings,"userProperties",null)},flespiLoginHandler:function(){var t=this,e=function e(n){"string"===typeof n.data&&~n.data.indexOf("FlespiToken")&&(t.currentSettings.username=n.data,window.removeEventListener("message",e))};window.addEventListener("message",e),this.openWindow("https://flespi.io/login/#/providers")},openWindow:function(t,e){e=e||"auth";var n=500,r=600,i=void 0!==window.screenLeft?window.screenLeft:screen.left,o=void 0!==window.screenTop?window.screenTop:screen.top,s=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,c=s/2-n/2+i,l=a/2-r/2+o,u=window.open(t,e,"toolbar=no,location=no,status=yes,resizable=yes,scrollbars=yes, width="+n+", height="+r+", top="+l+", left="+c);window.focus&&u.focus()}},watch:{settings:function(t){this.currentSettings=c()({},this.defaultSettings,t)}}},d=u,f=(n("84a3"),n("2877")),p=Object(f["a"])(d,o,s,!1,null,null,null);p.options.__file="ClientSettings.vue";var h=p.exports,m=n("f9d8"),g=n("b047c"),b=n.n(g),v=n("2b0e"),S=n("27ae"),_=n("5a50"),C=n("9224"),y=b()(function(t){m["a"].set(_["c"],t)},500,{trailing:!0}),w={name:"MyLayout",data:function(){return{leftDrawerOpen:this.$q.platform.is.desktop,clientSettingsOpened:!1,currentSettings:void 0,clients:{},activeClientId:void 0,editedClientId:void 0,connected:!1,version:C["a"],fullViewMode:!0}},computed:{clientsIds:function(){return Object.keys(this.clients)}},methods:{openSettings:function(){this.clientSettingsOpened=!0},hideSettingsHandler:function(){this.currentSettings=void 0,this.editedClientId=void 0},saveSettingsHandler:function(t){var e=this.editedClientId?this.editedClientId:this.clientsIds.length?parseInt(this.clientsIds[this.clientsIds.length-1])+1:0;v["default"].set(this.clients,e,t)},editClientSettings:function(t){this.currentSettings=this.clients[t],this.editedClientId=t,this.openSettings()},removeClient:function(t){var e=this;this.$q.dialog({title:"Warning",message:"Do you really want to delete ".concat(this.clients[t].clientName," client?"),color:"dark",ok:!0,cancel:!0}).then(function(){e.activeClientId===t&&(e.activeClientId=void 0),v["default"].delete(e.clients,t)})},setActiveClient:function(t){this.activeClientId=t,m["a"].set(_["a"],t)},changeStatus:function(t){this.connected=t},shareHandler:function(t){var e=this,n=this.clients[this.activeClientId].username,r=this.clients[this.activeClientId].syncNamespace,i={token:n,topic:r,boardId:t.boardId},o="".concat(window.location.href).concat(S["Base64"].encode(JSON.stringify(i)));this.$q.notify({message:"Link generated!",timeout:0,type:"info",icon:"mdi-share",position:"bottom-left",closeBtn:!0,actions:[{label:"Copy",handler:function(){e.$copyText(o).then(function(t){e.$q.notify({type:"positive",icon:"content_copy",message:"Link copied",timeout:1e3,position:"bottom-left"})},function(t){e.$q.notify({type:"negative",icon:"content_copy",message:"Error coping link",timeout:1e3,position:"bottom-left"})})}}]})}},created:function(){var t=this,e=this.$q.sessionStorage.get.item("mqtt-tiles-share");if(this.$route.params.hash||e){this.fullViewMode=!1;var n,r=l();n=this.$route.params.hash?JSON.parse(S["Base64"].decode(this.$route.params.hash)):e,this.$q.sessionStorage.set("mqtt-tiles-share",n),r.username=n.token,r.syncNamespace=n.topic,r.syncToRetain=!0,r.flespiBoard=n.boardId,v["default"].set(this.clients,0,r),this.setActiveClient(0)}else{var i=m["a"].get.item(_["c"]),o=m["a"].get.item(_["a"]);if(i){if(this.clients=i,this.$route.params.flespiToken){var s=this.$route.params.flespiToken.replace("FlespiToken ",""),a=this.clientsIds.filter(function(e){var n=t.clients[e].username.replace("FlespiToken ","");return s===n});if(a.length)o=a[0];else{var c=l();c.username=s;var u=(parseInt(this.clientsIds[this.clientsIds.slice(-1)])+1).toString();v["default"].set(this.clients,u,c),o=u}this.$router.push("/")}o&&this.clients[o]&&this.$nextTick(function(){t.setActiveClient(o)})}}},watch:{clients:{deep:!0,handler:function(t){this.fullViewMode&&y(t)}}},components:{clientSettings:h}},q=w,k=(n("eb60"),Object(f["a"])(q,r,i,!1,null,null,null));k.options.__file="MyLayout.vue";e["default"]=k.exports}}]);